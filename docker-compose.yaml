# Local development: MarkLogic + Grafana
# Usage: docker-compose up -d
# Grafana: http://localhost:3000 (admin/admin)
# MarkLogic Management API: http://localhost:8002

services:
  marklogic:
    image: progressofficial/marklogic-db
    ports:
      - "8000:8000"
      - "8001:8001"
      - "8002:8002"
    environment:
      MARKLOGIC_INIT: "true"
      MARKLOGIC_ADMIN_USERNAME: admin
      MARKLOGIC_ADMIN_PASSWORD: admin

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      GF_INSTALL_PLUGINS: ""
      GF_PLUGINS_ALLOW_LOADING_UNSIGNED_PLUGINS: grafana-marklogic-datasource
      GF_PATHS_PLUGINS: /var/lib/grafana/plugins
    volumes:
      - ./dist:/var/lib/grafana/plugins/grafana-marklogic-datasource
    depends_on:
      - marklogic
